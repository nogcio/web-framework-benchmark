{% import "partials/htmx/macros.rs.j2" as htmx %}
{% import "partials/ui/macros.rs.j2" as ui %}

{#
  Props (implicit via context):
  - selection: SelectionContext
  - variant: "mobile" (optional; default mobile)
#}

{% set v = variant|default("mobile") %}
{% set active_test = selection.active_test|test(selection.tests) %}

{% if v == "mobile" %}

{% call(test) ui::dropdown(
  component="test-menu",
  items=selection.tests,
  active_icon=active_test.icon,
  active_title=active_test.name,
  summary_classes="wfb-summary wfb-btn wfb-btn-xs",
  panel_side="left-0",
  panel_width="w-44",
  list_classes="",
  chevron_classes="h-3.5 w-3.5 text-muted-foreground"
) %}
	<a {{ htmx::wfb_results_anchor_attrs(selection.active_run_id, selection.active_env, test.id) }}
		class="wfb-menu-item gap-2 text-xs {% if selection.active_test.as_str() == test.id.as_str() %}wfb-menu-item-active{% else %}wfb-menu-item-inactive{% endif %}">
		{{ ui::icon(test.icon, "h-4 w-4") }}
		<span>{{ test.name }}</span>
	</a>
{% endcall %}
{% endif %}
